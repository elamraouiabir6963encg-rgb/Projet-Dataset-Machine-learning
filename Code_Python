# ===================================================
# INSTALLATION & IMPORTS
# ===================================================
# pip install ucimlrepo seaborn matplotlib pandas numpy

from ucimlrepo import fetch_ucirepo
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# ===================================================
# CHARGEMENT DU DATASET
# ===================================================
bank_marketing = fetch_ucirepo(id=222)

X = bank_marketing.data.features
y = bank_marketing.data.targets

# Fusion features + target
df = pd.concat([X, y], axis=1)

print("‚úÖ Aper√ßu des donn√©es :")
print(df.head())

print("\n‚úÖ Informations g√©n√©rales :")
print(df.info())

print("\n‚úÖ Statistiques descriptives :")
print(df.describe())

# ===================================================
# IDENTIFICATION DES VARIABLES NUM√âRIQUES
# ===================================================
num_cols = df.select_dtypes(include=['int64', 'float64']).columns

# ===================================================
# 1) VISUALISATION DES DISTRIBUTIONS : HISTOGRAMMES
# ===================================================
print("\n--- HISTOGRAMMES ---")

for col in num_cols:
    plt.figure(figsize=(6,4))
    sns.histplot(df[col], kde=True)
    plt.title(f"Distribution de {col}")
    plt.show()

    print(f"üìå Interpr√©tation - {col} :")
    print(f"- La distribution permet d‚Äôobserver la forme g√©n√©rale (sym√©trique, asym√©trique, extr√™mes).")
    print(f"- Une asym√©trie indique une concentration des valeurs vers une borne.")
    print(f"- La pr√©sence de pics sugg√®re des groupes de clients distincts.\n")

# ===================================================
# 2) BOXPLOTS (d√©tection des valeurs aberrantes)
# ===================================================
print("\n--- BOXPLOTS ---")

for col in num_cols:
    plt.figure(figsize=(6,3))
    sns.boxplot(x=df[col])
    plt.title(f"Boxplot de {col}")
    plt.show()

    print(f"üìå Interpr√©tation - {col} :")
    print("- Les points isol√©s repr√©sentent des valeurs aberrantes (outliers).")
    print("- Une bo√Æte large indique une forte dispersion.")
    print("- Une asym√©trie de la bo√Æte sugg√®re une distribution biais√©e.\n")

# ===================================================
# 3) HEATMAP DES CORR√âLATIONS
# ===================================================
print("\n--- HEATMAP DES CORR√âLATIONS ---")

plt.figure(figsize=(10,6))
corr = df[num_cols].corr()
sns.heatmap(corr, annot=True, cmap="coolwarm", fmt=".2f")
plt.title("Matrice de Corr√©lation")
plt.show()

print("üìå Interpr√©tation globale des corr√©lations :")
print("- Une corr√©lation proche de 1 ou -1 indique une relation forte.")
print("- Une valeur proche de 0 indique une ind√©pendance.")
print("- Les relations fortes peuvent indiquer une redondance de variables.")
print("- Utile pour la s√©lection des variables dans les mod√®les pr√©dictifs.")

# ===================================================
# 4) FEATURE ENGINEERING
# ===================================================
print("\n--- FEATURE ENGINEERING ---")

# 1Ô∏è‚É£ Cr√©ation variable 'age_group'
df['age_group'] = pd.cut(df['age'], bins=[0,30,45,60,100],
                          labels=['Jeune', 'Adulte', 'Senior', 'Tr√®s senior'])

# 2Ô∏è‚É£ Cr√©ation variable dur√©e par minute
df['duration_min'] = df['duration'] / 60

# 3Ô∏è‚É£ Cr√©ation variable nombre total de contacts
df['total_contacts'] = df['campaign'] + df['previous']

print("‚úÖ Nouvelles variables cr√©√©es :")
print(df[['age_group', 'duration_min', 'total_contacts']].head())

print("\nüìå Interpr√©tation des nouvelles variables :")
print("- age_group : segmentation client plus claire.")
print("- duration_min : plus interpr√©table que les secondes.")
print("- total_contacts : estimation de la pression commerciale sur le client.")

# ===================================================
# 5) VISUALISATION FEATURE ENGINEERING
# ===================================================
plt.figure(figsize=(6,4))
sns.histplot(df['duration_min'], kde=True)
plt.title("Distribution de la dur√©e de contact (minutes)")
plt.show()
print("üìå Interpr√©tation : Les appels courts dominent ‚Äî peu d‚Äôappels longs tr√®s influents.")

plt.figure(figsize=(6,4))
sns.countplot(x='age_group', data=df)
plt.title("R√©partition par groupe d'√¢ge")
plt.show()
print("üìå Interpr√©tation : Les adultes dominent le portefeuille clients.")

plt.figure(figsize=(6,4))
sns.histplot(df['total_contacts'], kde=True)
plt.title("Distribution du nombre total de contacts")
plt.show()
print("üìå Interpr√©tation : La majorit√© des clients est contact√©e peu de fois, signe de ciblage s√©lectif.")

# ===================================================
# FIN
# ===================================================
print("\n‚úÖ ANALYSE TERMIN√âE WITH SUCCESS")
